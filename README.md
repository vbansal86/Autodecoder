# Autodecoder

Matrix to scalar

1-11-2019
This notebook train a simple undercomplete autoencoder. The bottleneck layer consist of just single node and the input given to autoencoder is 2x2 matrix rolled into a vector of shape 1X4. Training is done so as to reconstructed the same matrix. 

The idea of this experiment is to understand if network is able to learn something important about the matrix through a scalar quantity of a 2x2 matrix.

The training examples are generated by randomly generating a 2x2 matrix using RANDINT of numpy in range of 1 to 10.
Then this matrix is multiplied with its transponsed so that the resulting matrix (ATA) is not a singular matrix. This I did just to make sure none of the randomly generated matrix has zero determinant. Matrices are divided by 200 to normalize them between 0 and 1.

I generated 200k such matrices and rolled it into dimension 200000X4 shape

180k such matrices are trained on an autoencoder with encoding of (8,8,4,4,2) , single node bottleneck and decoder of (2,4,4,8,8)
with input and output same dimensions(1X4)

It took around 304 epochs to achieve accuracy of 93.34 on validation  and validation loss of 0.0036
Different setting for Adam optimizers were used but best results were achieved from default settings. I think there is still room of improvement as the training accuracy bounces off by 5-10% after every 10-15 epochs.

Below is sample output from prediction from totally unseen matrix

matrix b before normalization is 
 [[113  79]
 [ 79  82]]

Input matrix b = [[ 0.565  0.395  0.395  0.41 ]]
Reconstructed  matrix = [[ 0.53636318  0.38514462  0.38599965  0.33468974]]

Reconstructed matrix is  close to the original one though there is little  deviation in last element,that can be attributed to the bouncing training loss during training and I believe could be fixed

Now coming to the bottleneck layer
Encoder output of matrix is [[ 0.25088343]]

The scalar quantity learned by this network from above matrix is 0.25
The properties of matrix as 

Determinant of b is 0.07562499999999996
Eigenvalues of b is [ 0.89003105  0.08496895]
norm of b  0.894077737112

None of the important properties of matrix b matches that of the scalar quantity we obtained in prediction - 0.25


I will continue analysis of this little experiment but I have belief that the scalar quantity could be relate to original matrix in some way. 






